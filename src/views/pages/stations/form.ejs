<%- include('../../partials/head', { title: station ? 'Modifier ' + station.name : 'Nouvelle station' }) %>

<body class="bg-gray-100 min-h-screen flex flex-col">
  <%- include('../../partials/header') %>

  <main class="container mx-auto py-8 px-4 grow">
    <a href="/stations" class="inline-flex items-center gap-1 text-blue-500 hover:text-blue-700 mb-6">
      <%- icon('ArrowLeft', { size: 18 }) %>
      Retour a la liste
    </a>

    <div class="bg-white rounded-lg shadow-lg p-8 max-w-2xl">
      <h1 class="text-3xl font-bold text-gray-800 mb-6">
        <%= station ? 'Modifier la station' : 'Ajouter une station' %>
      </h1>

      <% if (typeof errors !== 'undefined' && errors && errors.length > 0) { %>
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
          <p class="font-bold">Erreurs de validation :</p>
          <ul class="list-disc list-inside mt-2">
            <% errors.forEach(error => { %>
              <li><%= error.message %></li>
            <% }) %>
          </ul>
        </div>
      <% } %>

      <form method="POST" action="<%= station ? '/stations/' + station.id + '/edit' : '/stations/new' %>" class="space-y-6">
        <div>
          <label for="name" class="block text-gray-700 font-medium mb-2">Nom de la station *</label>
          <input
            type="text"
            id="name"
            name="name"
            value="<%= (typeof formData !== 'undefined' && formData.name) || (station && station.name) || '' %>"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            required
          >
        </div>

        <h3 class="text-lg font-semibold text-gray-700 border-b pb-2">Specifications</h3>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label for="cpu" class="block text-gray-700 font-medium mb-2">CPU *</label>
            <input
              type="text"
              id="cpu"
              name="cpu"
              value="<%= (typeof formData !== 'undefined' && formData.cpu) || (station && station.cpu) || '' %>"
              placeholder="Ex: Intel Core i9-13900K"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
          </div>
          <div>
            <label for="gpu" class="block text-gray-700 font-medium mb-2">GPU *</label>
            <input
              type="text"
              id="gpu"
              name="gpu"
              value="<%= (typeof formData !== 'undefined' && formData.gpu) || (station && station.gpu) || '' %>"
              placeholder="Ex: NVIDIA RTX 4090"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label for="ram" class="block text-gray-700 font-medium mb-2">RAM *</label>
            <input
              type="text"
              id="ram"
              name="ram"
              value="<%= (typeof formData !== 'undefined' && formData.ram) || (station && station.ram) || '' %>"
              placeholder="Ex: 32GB DDR5"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
          </div>
          <div>
            <label for="storage" class="block text-gray-700 font-medium mb-2">Stockage *</label>
            <input
              type="text"
              id="storage"
              name="storage"
              value="<%= (typeof formData !== 'undefined' && formData.storage) || (station && station.storage) || '' %>"
              placeholder="Ex: 2TB NVMe SSD"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
          </div>
        </div>

        <h3 class="text-lg font-semibold text-gray-700 border-b pb-2">Peripheriques</h3>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label for="monitor" class="block text-gray-700 font-medium mb-2">Ecran *</label>
            <input
              type="text"
              id="monitor"
              name="monitor"
              value="<%= (typeof formData !== 'undefined' && formData.monitor) || (station && station.monitor) || '' %>"
              placeholder="Ex: ASUS ROG Swift 27&quot; 240Hz"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
          </div>
          <div>
            <label for="keyboard" class="block text-gray-700 font-medium mb-2">Clavier *</label>
            <input
              type="text"
              id="keyboard"
              name="keyboard"
              value="<%= (typeof formData !== 'undefined' && formData.keyboard) || (station && station.keyboard) || '' %>"
              placeholder="Ex: Corsair K95 RGB Mechanical"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label for="mouse" class="block text-gray-700 font-medium mb-2">Souris *</label>
            <input
              type="text"
              id="mouse"
              name="mouse"
              value="<%= (typeof formData !== 'undefined' && formData.mouse) || (station && station.mouse) || '' %>"
              placeholder="Ex: Logitech G Pro X Superlight"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
          </div>
          <div>
            <label for="headset" class="block text-gray-700 font-medium mb-2">Casque *</label>
            <input
              type="text"
              id="headset"
              name="headset"
              value="<%= (typeof formData !== 'undefined' && formData.headset) || (station && station.headset) || '' %>"
              placeholder="Ex: SteelSeries Arctis Pro"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
          </div>
        </div>

        <div>
          <label for="status" class="block text-gray-700 font-medium mb-2">Statut *</label>
          <select
            id="status"
            name="status"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            required
          >
            <% const currentStatus = (typeof formData !== 'undefined' && formData.status) || (station && station.status) || 'available' %>
            <option value="available" <%= currentStatus === 'available' ? 'selected' : '' %>>Disponible</option>
            <option value="maintenance" <%= currentStatus === 'maintenance' ? 'selected' : '' %>>Maintenance</option>
            <option value="booked" <%= currentStatus === 'booked' ? 'selected' : '' %>>Reservee</option>
          </select>
        </div>

        <div class="flex gap-4">
          <button
            type="submit"
            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg transition-colors"
          >
            <%= station ? 'Enregistrer' : 'Ajouter' %>
          </button>
          <a
            href="/stations"
            class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-6 rounded-lg transition-colors"
          >
            Annuler
          </a>
        </div>
      </form>
    </div>
  </main>

  <%- include('../../partials/footer') %>
</body>
</html>
