<%- include('../../partials/head', { title: game ? 'Modifier ' + game.name : 'Nouveau jeu' }) %>

<body class="bg-gray-100 min-h-screen flex flex-col">
  <%- include('../../partials/header') %>

  <main class="container mx-auto py-8 px-4 grow">
    <a href="/games" class="inline-flex items-center gap-1 text-blue-500 hover:text-blue-700 mb-6">
      <%- icon('ArrowLeft', { size: 18 }) %>
      Retour a la liste
    </a>

    <div class="bg-white rounded-lg shadow-lg p-8 max-w-2xl">
      <h1 class="text-3xl font-bold text-gray-800 mb-6">
        <%= game ? 'Modifier le jeu' : 'Ajouter un jeu' %>
      </h1>

      <% if (typeof errors !== 'undefined' && errors && errors.length > 0) { %>
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
          <p class="font-bold">Erreurs de validation :</p>
          <ul class="list-disc list-inside mt-2">
            <% errors.forEach(error => { %>
              <li><%= error.message %></li>
            <% }) %>
          </ul>
        </div>
      <% } %>

      <form method="POST" action="<%= game ? '/games/' + game.id + '/edit' : '/games/new' %>" class="space-y-6">
        <div>
          <label for="name" class="block text-gray-700 font-medium mb-2">Nom du jeu *</label>
          <input
            type="text"
            id="name"
            name="name"
            value="<%= (typeof formData !== 'undefined' && formData.name) || (game && game.name) || '' %>"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            required
          >
        </div>

        <div>
          <label for="genre" class="block text-gray-700 font-medium mb-2">Genre *</label>
          <input
            type="text"
            id="genre"
            name="genre"
            value="<%= (typeof formData !== 'undefined' && formData.genre) || (game && game.genre) || '' %>"
            placeholder="Ex: FPS, MOBA, RPG..."
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            required
          >
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label for="minPlayers" class="block text-gray-700 font-medium mb-2">Joueurs min *</label>
            <input
              type="number"
              id="minPlayers"
              name="minPlayers"
              value="<%= (typeof formData !== 'undefined' && formData.minPlayers) || (game && game.minPlayers) || '' %>"
              min="1"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
          </div>
          <div>
            <label for="maxPlayers" class="block text-gray-700 font-medium mb-2">Joueurs max *</label>
            <input
              type="number"
              id="maxPlayers"
              name="maxPlayers"
              value="<%= (typeof formData !== 'undefined' && formData.maxPlayers) || (game && game.maxPlayers) || '' %>"
              min="1"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
          </div>
        </div>

        <div>
          <label for="releaseYear" class="block text-gray-700 font-medium mb-2">Annee de sortie</label>
          <input
            type="number"
            id="releaseYear"
            name="releaseYear"
            value="<%= (typeof formData !== 'undefined' && formData.releaseYear) || (game && game.releaseYear) || '' %>"
            min="1970"
            max="<%= new Date().getFullYear() + 1 %>"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          >
        </div>

        <div>
          <label for="description" class="block text-gray-700 font-medium mb-2">Description</label>
          <textarea
            id="description"
            name="description"
            rows="4"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          ><%= (typeof formData !== 'undefined' && formData.description) || (game && game.description) || '' %></textarea>
        </div>

        <div class="flex gap-4">
          <button
            type="submit"
            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg transition-colors"
          >
            <%= game ? 'Enregistrer' : 'Ajouter' %>
          </button>
          <a
            href="/games"
            class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-6 rounded-lg transition-colors"
          >
            Annuler
          </a>
        </div>
      </form>
    </div>
  </main>

  <%- include('../../partials/footer') %>
</body>
</html>
